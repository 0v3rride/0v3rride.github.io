![Linkedin](Post%20Images/linkedin.png) [Linkedin](https://www.linkedin.com/in/ryangore/) | ![Github](Post%20Images/github.png) [Github](https://github.com/0v3rride)

# Divergent: The Curious View Into The Mind Of A Malware Creator & Jackass (Part 1)
_____________________________________________________________________


### Preface
Once upon a time at Microsoft Corporation sometime in 1996, a group of individuals thought it would be an excellent idea to allow for arbitrary code execution and calls to the Operating System via webpages rendered in Internet Explorer. This idea came in the form of [ActiveX](https://en.wikipedia.org/wiki/ActiveX), but more specifically ActiveX controls. ActiveX controls are very similar to Java applets, which in short means they're dangerous too. This is not a new revelation, but it is a problem that continues to persist in the Windows ecosystem, even the with the advent of Windows 10 and IE 11. You can read more about he specifics [here.](http://www.tezu.ernet.in/~utpal/course_mat/com_ole_actvx/) This 'malware' strain doesn't have a name yet, so I'll call it Divergent due to the executable it drops on the victim machine.

### Overview
Sometime shortly after the first of Feburary, my orginization's EDR solution began alerting us to a generic trojan it was finding on three endpoints belonging to external users. We weren't able to exactly pinpoint the cause of infection, but after viewing the downloads history for one of the victims we observed that a file named ```Player(random_numbers).hta``` was downloaded and pressumably executed via social engineering or plain old end user ignorance. The malware created the following files in the following directories starting at the ```C:\Users\<UserName>\``` directory:
```
|----ProgramData
     |----(randomly_Generated_Name).hta
     |----02sall.js
     |----SystemInformation
          |----node_modules
               |----(I honestly don't remember what was in here off the top of my head, becasue it wasn't important) :)
          |----app.js
          |----constants.js
          |----divergent.exe
          |----mdivergent.exe
          |----node.exe
          |----socks4a.js
          |----WinDivert.dll
          |----WinDivert32.sys
          |----WinDivert64.sys
```
Clean up was simple as this piece of malware is an absolute joke. Looking at the logs, our EDR solution was cleaning and removing zip files. We aren't exactly sure what was in those zip files, but we assumed it was a payload of some sorts or the more components of the malware which were needed in order for it to function fully.

### Summary Of The Inner Workings Of 02Sall.js

I'm not posting the full payload in this entry, but you can download a copy of the sample from [here.](https://github.com/0v3rride/Malware-Samples/tree/master/Divergent)

####Setting Up Variables
```
```

####Some Evasion Techniques
```
```

####Instantiating ActiveXObjects
```
```

### Conclusion

### Credits

